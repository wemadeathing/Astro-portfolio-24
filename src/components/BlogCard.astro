---
interface Props {
  title: string;
  image: string;
  slug: string;
  kicker?: string;
  pubDate?: Date;
  readingTime?: string;
  series?: {
    name: string;
    order: number;
  };
}

const { title, image, slug, kicker, pubDate, readingTime, series } = Astro.props;

const formattedDate = pubDate
  ? new Intl.DateTimeFormat('en-US', { month: 'short', day: 'numeric', year: 'numeric' }).format(pubDate)
  : null;
---

<a
  href={`/blog/${slug}`}
  class="group block rounded-[24px] border border-white/[0.12] bg-[#08080c]/95 overflow-hidden shadow-[0_18px_40px_rgba(0,0,0,0.65)] transition-all hover:-translate-y-0.5 hover:border-white/30 focus:outline-none focus-visible:ring-4 focus-visible:ring-primary/20"
>
  <div class="aspect-video overflow-hidden bg-white/5 relative">
    <div class="absolute inset-0 skeleton-image" aria-hidden="true"></div>
    {series ? (
      <div class="absolute top-3 left-3 z-10 rounded-full border border-white/10 bg-black/60 backdrop-blur-md px-2.5 py-1 text-[10px] font-bold uppercase tracking-wider text-white/90 shadow-sm">
        Part {series.order}
      </div>
    ) : null}
    <img
      src={image}
      alt={title}
      class="relative w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"
      loading="lazy"
      decoding="async"
      onload="this.parentElement.querySelector('.skeleton-image').style.display='none'"
    />
  </div>
  <div class="px-4 pb-5 pt-4">
    <div class="flex items-center gap-2 text-[11px] tracking-[0.22em] uppercase text-white/55 line-clamp-1">
      {series ? (
        <span class="text-primary/90 font-bold">{series.name}</span>
      ) : (
        kicker && <span>{kicker}</span>
      )}
    </div>
    <h2 class:list={[
      'text-[15px] sm:text-base font-semibold text-white/92 group-hover:text-primary transition-colors line-clamp-3 leading-snug',
      'mt-2',
    ]}>
      {title}
    </h2>
    {(formattedDate || readingTime) && (
      <p class="mt-2 text-xs text-white/55">
        {formattedDate}{formattedDate && readingTime && ' â€¢ '}{readingTime}
      </p>
    )}
  </div>
</a>
